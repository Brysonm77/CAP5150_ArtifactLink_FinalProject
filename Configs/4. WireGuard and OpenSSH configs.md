# All configurations for Wireguard will be here (i.e., additional VPN IP allocations, allowed peers, and key generation). Due to lack of configuration, OpenSSH configs will also be in this file.

## WireGuard (WG)
### Key-Gen
#### Ubuntu server
* Key generation 
  * cd /etc/wireguard
  * sudo umask 077
    * permissions given to the owner
  * sudo wg genkey | tee server_private.key | wg pubkey > server_public.key
    * creates a private key for WG
   
* Deploying WG configs
    * NOTE: the following includes all clients at  the end of the project. Each client was added indivdiually throughout the project
  * sudo nano /etc/wireguard/wg0.conf
```
[Interface]
PrivateKey = <WG private key> # For security reasons, Private Key WILL NOT be shared
Address = 10.0.0.1/24
ListenPort 51280

[Peer]
PublicKey = BCOcenm5Ond0K8d8PZXmFSAKpl6WRLNR1UOyGv081bM=
AllowedIPs = 10.0.0.2/32

[Peer]
PublicKey =O0avtbyWSjdEki+SduDDm158O2oNec0ns+rupsTJRDA=
AllowedIPs = 10.0.0.3/32

[Peer]
PublicKey = tyBI4335oiXa+w2MI4bHkSd5/swot/kcEa9Uyt5SdkY=
AllowedIPs = 10.0.0.4/32

[Peer]
PublicKey = eIbGynfI11vrCntQEHR0UIU5nlYVwrOHBfG4MqtSWQY=
AllowedIPs = 10.0.0.5/32
```
* sudo systemctl enable wg-quick@wg0
  * tells the system to start WG on boot
* sudo systemclt start wg-quick@wgo
  * starts the interface 
* sudo wg show
  * used to see if the changes went through
* ADDING a new client:
    * sudo wg set wg0 peer <NEW CLIENT KEY> allowed-ips 10.0.0.X/32
    * sudo systemctl restart wg-quick@wg0

 #### Windows VM 
 * Open app > "add empty tunnel" > name 
```
[Interface]
PrivateKey = <WIN private key> # For security reasons, Private Key WILL NOT be shared
Address = 10.0.0.x/24 # where x is the corresponding client octet

[Peer]
PublicKey = MLJP69zFQdAFkLtR2xnzqwPtWKdYFiLMHfqgiWBXR0Y=
AllowedIPs = 10.0.0.0/24
Endpoint = 10.10.10.1:51820
PersistentKeepAlive = 15
```

## OpenSSH
#### Ubuntu Server
* As mentioned before, OpenSSH came pre-installed on Ubuntu. If install is required run the following:
  * sudo apt update
  * sudo apt install openssh-server
 
``` # Allowed users and Blocked users need to be implemened only in the server ```
* sudo add user alloweduser
* sudo add user blockeduser
* sudo nano /etc/ssh/sshd_config
  * enter configuration file and scroll to the very bottom
* AllowUsers alloweduser
  * DO NOT add blockeduser, they will be used to test user access within the server
* sudo systemctl restart sshd

#### Clients
* As mentioned before, OpenSSH came pre-installed on Win 11. If install is required run the following in PowerShell:
  * Add-WindowCapability -Online -Name OpenSSH.Client~~~~0.0.1.0
